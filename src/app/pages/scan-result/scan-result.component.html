<div class="row m-5">

    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
        <!-- <div *ngIf="!!searchKeys && searchKeys.length > 0"> -->


            <div class="card">
                <div class="card-body base-bg-color">
                   
                    <div class="row col-12 mb-3">
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-xs-12">
                            <select (change)="changeKey($event)" class="form-select form-control col-xl-4 col-lg-4 col-md-12 col-sm-12 col-xs-12" aria-label="Default select example">
                                <option *ngFor="let key of searchKeys" value="{{key}}">{{key}}</option>
                              </select>
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-xs-12 text-right text-xs-left text-sm-left">
                            <button class="btn btn-fill btn-danger" (click)="downloadReport()">Download Scan Result</button>
                        </div>
                        
                        
                    </div>
                    <div class="row col-12">
                        <div class="row col-xl-6 col-l-6 col-md-6 col-sm-12 col-xs-12 text-white pb-1">
                            <span class="scan-result-title">Search Results: <span class="result-key-text">{{selectedKey}}</span></span>
                        </div>
                        <!-- <div class="row col-xl-6 col-l-6 col-md-6 col-sm-12 col-xs-12 text-white pb-1 text-right">
                            <span class="scan-result-title">Search Results: <span class="result-key-text">{{selectedKey}}</span></span>
                        </div> -->
                    </div>
                    
                    <div *ngIf="!!categories && categories.length > 0" class="row col-12">

                        <div *ngFor="let category of categories;"
                            class="col-xs-12 col-sm-12 col-md-12 col-lg-6 col-xl-6 border-bottom p-2 pl-4 bg-light">
                            <span class="category-label">{{category.key}} </span>
                            <span *ngIf="!!category.key" class="category-value">: {{category.value}}</span>
                        </div>
                    </div>
                    <div *ngIf="!!results && results.length > 0" class="row col-12 m-2">
                       
                            <div *ngFor="let result of results" class="row col-xs-12 col-sm-12 col-md-12 col-lg-6 col-xl-6 border-bottom p-2 pl-4 bg-light text-nowrap">
                                <div class="col-4 text-capitalize">
                                    {{result.key}}
                                </div>
                                <div class="col-1">
                                    <span>
                                        <i *ngIf="result.category==='harmless'" class="fas fa-check-circle result-success-icon pr-1"></i>
                                        <i *ngIf="result.category==='malicious'" class="fas fa-times-circle result-error-icon pr-1"></i>
                                        <!-- <i class="far fa-question-circle"></i> -->
                                        <i *ngIf="result.category==='undetected' && !!result.result" class="fas fa-question-circle result-undetected-icon pr-1"></i>
                                        <i *ngIf="result.category==='undetected' && !result.result" class="fas fa-check-circle result-success-icon pr-1"></i>
                                        <i *ngIf="result.category==='type-unsupported'" class="far fa-eye-slash result-undetected-icon pr-1"></i>
                                    </span>
                                </div>
                                <div class="col-7 text-capitalize">
                                    <span *ngIf="!!result.result">{{result.result}}</span>
                                    <span *ngIf="!result.result">{{result.category}}</span>
                                </div>
                                
                            </div>
                     
                        
                    </div>


                </div>
            </div>
        <!-- </div> -->
    </div>

</div>